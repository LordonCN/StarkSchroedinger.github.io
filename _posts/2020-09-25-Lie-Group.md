---
layout:     post
title:      "Visual Slam笔记——李群和李代数"
subtitle:   "Visual SLAM笔记"
date:       2020-09-25
author:     "Felix Zhang"
header-img: "img/in-post/2020-02-10-LeetCode-Notes/bg.jpg"
catalog: true
tags:
   - Visual SLAM
---

# 李群和李代数

## 问题的引入

当我们估计出相机姿态$[R, t]$了以后，估计的结果和实际的相机姿态肯定会有一些不一致性，因而我们需要对估计出来的结果进行微调。但是，旋转矩阵并没有良好定义的加法，即$R_1$和$R_2$是都是旋转矩阵，但是$R_1+R_2$并不符合旋转矩阵的定义：

旋转矩阵应该满足$RR^T = I$，且$det(R) = 1$，即**行列式的值为1的正交矩阵**，因此上边的结论是显而易见的。

因此，在实际操作中，我们无法通过如下的微调满足我们对相机观测模型的优化：
$$
\begin{equation}
[R, t] \stackrel{\Delta R, \Delta t}{\longrightarrow} [R', t']
\end{equation}
$$

$$
t' = t + \Delta t
$$

$$
R' = R + \Delta R
$$

因而也会影响到观测模型（关于旋转矩阵的函数）对$R$的求导，因为通常来说我们的导数定义为：
$$
U(R) = \frac{dU}{dR} = \lim\limits_{\Delta R \to 0}\frac{U(R + \Delta R) - U(R)}{\Delta R}
$$
没有良好定义的加法——没有传统意义上的导数定义。

因此，李群和李代数是**间接对$R$进行求导**的。



## 预备知识

### 矩阵指数

首先要引入矩阵指数的概念（Matrix Exponential）。矩阵指数可以由线性微分方程的解的形式导出，比如有一阶线性微分方程：
$$
\stackrel{·}{x} = ax(t)
$$
其中，$x(t) \in \mathbb{R}$，$a \in \mathbb{R}$，并且初始分布为$x(0) = x_0$，那么解为：
$$
x(t) = e^{at}x_0
$$
其中指数函数可以展开为无穷级数：
$$
e^{at} = 1 + at + \frac{(at)^2}{2!} + \frac{(at)^3}{3!} + ···
$$
同理，如果我们对三维向量由一阶线性微分方程：
$$
\stackrel{·}{x}(t) = Ax(t)
$$
其中$x(t) \in \mathbb{R}^3$，$A \in \mathbb{R}^{3 \times 3}$，且初始条件为$x(0) = x_0$，那么解为：
$$
x(t) = e^{At}x_0
$$
其中矩阵指数函数可以展开为无穷级数的形式：
$$
e^{At} = I + At + \frac{(At)^2}{2!} + \frac{(At)^3}{3!} + ···
$$

### 矩阵指数与矩阵旋转的关系

![向量旋转](../img/in-post/2020-09-25-Lie-Group/向量旋转.png)

如上图所示

如上图，三维向量$p(0)$绕着单位旋转轴$\hat{\omega}$  （$\hat{\omega} \in \mathbb{R}^3$，$||\hat\omega|| = 1$）旋转$\theta$角度，得到三维向量 $p(\theta)$。该旋转运动亦可以视作是三维向量$p(0)$以$1rad/s$的角速度绕着单位旋转轴$\hat{\omega}$从时间$t = 0$ 运动到时间 $t = \theta$得到三维向量$p(\theta)$。

如果用$p(t)$来表示旋转路径上向量端点处的位置，用$\stackrel{·}{p}(t)$表示该点的瞬时速度值，则有：
$$
\stackrel{·}{p} = \hat{\omega} \times p
$$
而向量叉乘可以写为左端向量对应的反对称矩阵与右端向量的乘积形式：
$$
\stackrel{·}{p} = [\hat{\omega}]p
$$


其中，定义$[·]$为反对称矩阵算子，假如$\hat{\omega} = \begin{Bmatrix} \omega_1 \\ \omega_2 \\ \omega_3 \end{Bmatrix}$，那么有：
$$
[\omega] = 
\begin{bmatrix}
0 & -\omega_{3} & \omega_{2} \\
\omega_{3} & 0 & -\omega_{1} \\
-\omega_{2} & \omega_{1} & 0
\end{bmatrix}
$$


那么上式就有如下解：
$$
p(t) = e^{[\hat\omega]t}p(0)
$$


因为角速度为$1rad/s$，所以这里角度$\theta$和时间$t$是可以互换的：
$$
p(t) = e^{[\hat\omega]\theta}p(0)
$$


由于反对称矩阵有满足${[\hat\omega]}^3 = -[\hat\omega]$，将矩阵指数函数展开有：
$$
\begin{align}
e^{[\hat\omega]\theta} 
&= I + [\hat\omega]\theta + [\hat\omega]^2\frac{\theta ^ 2}{2!} + [\hat\omega]^3\frac{\theta ^ 3}{3!} + ··· \\
&= I + (\theta - \frac{\theta ^ 3}{3!} + \frac{\theta ^ 5}{5!} - ···)[\hat\omega] + （\frac{\theta ^ 2}{2!} - \frac{\theta ^ 4}{4!} + \frac{\theta ^ 6}{6!}-···）[\hat\omega] ^ 2 \\
&= I + \sin{\theta}[\hat\omega] + (a-\cos{\theta})[\hat\omega] ^ 2
\end{align}
$$


因此，三维旋转矩阵$R$就可以用矩阵指数$e^{[\hat{\omega}]\theta}$的形式来表示。

## 李群和李代数

### 群

群是一种**集合**加上一种**代数运算**。这个集合和运算应该满足“封结幺逆”四个性质，我们称为某集合对某运算**成群**。


$$
SO(3) = \{R \in \mathbb{R}^{3 \times 3} | RR^T = I, det(R) = 1\}
$$

$$
SE(3) = \{ T = \begin{bmatrix} R & t \\ {0^T} & 1 \\ \end{bmatrix} \in \mathbb{R}^{4\times 4} | R \in SO(3), t \in \mathbb{R}^{3\times 3}\}
$$



下面由旋转矩阵$R$引出李代数。因为R是随时间连续变化的——相机可看成是连续运动，我们将相机姿态看作是时间t的函数，那么自然就有$R(t)R(t)^T = I$成立。上式的左右两侧同时对t求导，我们可得
$$
\stackrel{·}{R}(t)R(t)^T + R(t)\stackrel{·}{R}(t)^T  = 0
$$
整理后可得
$$
\stackrel{·}{R}(t)R(t)^T = -{( R(t)\stackrel{·}{R}(t)^T )}^T
$$
如果我们把等式左边看成一个整体，那么我们会发现上式左边是一个反对陈矩阵。

对于任意一个反对称矩阵，我们都由一个向量做反对称变换得到，比如：
$$
a^{\wedge} = A = \begin{bmatrix} 0 & -a_3 & a_2 \\ a_3 & 0 & -a_1 \\ -a_2 & a_1 & 0 \\ \end{bmatrix},

\quad A^{\vee} = a = \{a_1, a_2, a_3\}.
$$
如果将上式左边记为$\phi(t)^{\wedge} = \stackrel{·}{R}(t)R(t)^T$，我们对这个式子两边右乘$R(t)$并注意到$R(t)$的正交矩阵性质，就可以得到：
$$
\stackrel{·}{R}(t) = \phi^{\wedge}(t)R(t)
$$
就好像对R(t)求导后其实是左乘了一个$\phi(t)$。

## 指数映射和对数映射



## 求导与扰动模型